<html>

<head>
<title>Sample Sampling Profiler for COM</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body>

<h1>Sample Sampling Profiler for COM+ SDK</h1>

<p>This sample starts a user thread with high priority in the process which tracks all
managed threads, and at a set frequency samples the current IP for each thread.&nbsp; At
the end of the run, the samples are recorded into a comma separated output file that can
be imported into Excel and analyzed.</p>

<p><a href="#Using the Profiler">Using the Profiler</a></p>

<p><a href="#Importing the Sampling Data">Importing the Sampling Data</a></p>

<p><a href="#Options Summary">Options Summary</a></p>

<hr>

<h3><a name="Using the Profiler">Using the Profiler</a></h3>

<p>The profiler is enabled in the following way:

<ol>
  <li>Register the profiling DLL:&nbsp; <font face="Courier" color="#008080">regsvr32
    mscorprf.dll</font></li>
  <li>Tell the Runtime what profiling DLL to load:&nbsp; <font face="Courier" color="#008080">set
    COR_PROFILER={0104AD6E-8A3A-11d2-9787-00C04F869706}</font></li>
  <li>Enable profiling for the process:&nbsp; <font face="Courier" color="#008080"> set
    CORDBG_ENABLE=0x20</font></li>
  <li>Start the client application</li>
</ol>

<p>When run in this mode, the EE will create the profiling callback and notify it about
the threads and other events that are occuring.&nbsp; Please see the Profiling Spec for
more information.</p>

<h3><a name="Importing the Sampling Data">Importing the Sampling Data</a></h3>

<p><font color="#FF0000">&lt;&lt;&lt;&nbsp; Jayanth:&nbsp; please add your information
here with your macro &gt;&gt;&gt;</font></p>

<h3><a name="Options Summary">Options Summary</a></h3>

<p>In addition to the COR_PROFILER and CORDBG_ENABLE values which enable and locate the
profiler, the following settings are also possible using the PROF_CONFIG variable:</p>

<table border="1" width="50%">
  <tr>
    <td width="50">/s</td>
    <td width="50%">Samle frequency</td>
  </tr>
  <tr>
    <td width="50">/d</td>
    <td width="50%">Dump frequence</td>
  </tr>
  <tr>
    <td width="50">/o</td>
    <td width="50%">Output file name</td>
  </tr>
</table>
</body>
</html>
