//////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2000-2002 Microsoft Corporation
//
//  Module Name:
//      CTaskUpgradeWin2k.h
//
//  Description:
//      This file contains the declaration of the class CTaskUpgradeWindows2000.
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//  Implementation Files:
//      CTaskUpgradeWin2k.cpp
//
//  Maintained By:
//      David Potter    (DavidP)    07-SEP-2001
//      Vij Vasu        (Vvasu)     26-JUL-2000
//
//////////////////////////////////////////////////////////////////////////////

#pragma once

//////////////////////////////////////////////////////////////////////////////
// Include Files
//////////////////////////////////////////////////////////////////////////////

// For the base class
#include "CTaskUpgrade.h"


//////////////////////////////////////////////////////////////////////////////
// Forward Declarations
//////////////////////////////////////////////////////////////////////////////

class CTaskUpgradeWindows2000;

//////////////////////////////////////////////////////////////////////////////
// External Declarations
//////////////////////////////////////////////////////////////////////////////

class CClusOCMApp;


//////////////////////////////////////////////////////////////////////////////
//++
//
//  class CTaskUpgradeWindows2000
//
//  Description:
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//--
//////////////////////////////////////////////////////////////////////////////
class CTaskUpgradeWindows2000 : public CTaskUpgrade
{
public:
    //////////////////////////////////////////////////////////////////////////
    // Public constructors and destructors
    //////////////////////////////////////////////////////////////////////////

    // Constructor.
    CTaskUpgradeWindows2000( const CClusOCMApp & rAppIn );

    // Destructor
    virtual ~CTaskUpgradeWindows2000( void );


    //////////////////////////////////////////////////////////////////////////
    // Message handlers
    //////////////////////////////////////////////////////////////////////////

    // Handler for the OC_QUEUE_FILE_OPS message.
    virtual DWORD
        DwOcQueueFileOps( HSPFILEQ hSetupFileQueueIn );

    // Handler for the OC_COMPLETE_INSTALLATION message.
    virtual DWORD
        DwOcCompleteInstallation( void );

    // Handler for the OC_CLEANUP message.
    virtual DWORD
        DwOcCleanup( void );


protected:
    //////////////////////////////////////////////////////////////////////////
    // Protected methods
    //////////////////////////////////////////////////////////////////////////

    // Map ids specified in the INF file to actual directories.
    DWORD DwSetDirectoryIds( void );


private:
    //////////////////////////////////////////////////////////////////////////
    // Forbidden methods
    //////////////////////////////////////////////////////////////////////////

    //
    // Copying an object of this class is not allowed.
    //

    // Private copy constructor.
    CTaskUpgradeWindows2000( const CTaskUpgradeWindows2000 & );

    // Private assignment operator.
    const CTaskUpgradeWindows2000 & operator =( const CTaskUpgradeWindows2000 & );

    //////////////////////////////////////////////////////////////////////////
    // Private types
    //////////////////////////////////////////////////////////////////////////
    typedef CTaskUpgrade BaseClass;

}; //*** class CTaskUpgradeWindows2000
