//////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2000-2002 Microsoft Corporation
//
//  Module Name:
//      CTaskUpgradeWhistler.h
//
//  Implementation Files:
//      CTaskUpgradeWhistler.cpp
//
//  Description:
//      This file contains the declaration of the class CTaskUpgradeWindowsDotNet.
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//  Maintained By:
//      David Potter    (DavidP)    07-SEP-2001
//      Vij Vasu        (Vvasu)     26-JUL-2000
//
//////////////////////////////////////////////////////////////////////////////

#pragma once

//////////////////////////////////////////////////////////////////////////////
// Include Files
//////////////////////////////////////////////////////////////////////////////

// For the base class
#include "CTaskUpgrade.h"


//////////////////////////////////////////////////////////////////////////////
// Forward Declarations
//////////////////////////////////////////////////////////////////////////////

class CTaskUpgradeWindowsDotNet;

//////////////////////////////////////////////////////////////////////////////
// External Declarations
//////////////////////////////////////////////////////////////////////////////

class CClusOCMApp;


//////////////////////////////////////////////////////////////////////////////
//++
//
//  class CTaskUpgradeWindowsDotNet
//
//  Description:
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//--
//////////////////////////////////////////////////////////////////////////////
class CTaskUpgradeWindowsDotNet : public CTaskUpgrade
{
public:
    //////////////////////////////////////////////////////////////////////////
    // Public constructors and destructors
    //////////////////////////////////////////////////////////////////////////

    // Constructor.
    CTaskUpgradeWindowsDotNet( const CClusOCMApp & rAppIn );

    // Destructor
    virtual ~CTaskUpgradeWindowsDotNet( void );


    //////////////////////////////////////////////////////////////////////////
    // Message handlers
    //////////////////////////////////////////////////////////////////////////

    // Handler for the OC_QUEUE_FILE_OPS message.
    virtual DWORD
        DwOcQueueFileOps( HSPFILEQ hSetupFileQueueIn );

    // Handler for the OC_COMPLETE_INSTALLATION message.
    virtual DWORD
        DwOcCompleteInstallation( void );

    // Handler for the OC_CLEANUP message.
    virtual DWORD
        DwOcCleanup( void );


protected:
    //////////////////////////////////////////////////////////////////////////
    // Protected methods
    //////////////////////////////////////////////////////////////////////////

    // Map ids specified in the INF file to actual directories.
    DWORD DwSetDirectoryIds( void );


private:
    //////////////////////////////////////////////////////////////////////////
    // Forbidden methods
    //////////////////////////////////////////////////////////////////////////

    //
    // Copying an object of this class is not allowed.
    //

    // Private copy constructor.
    CTaskUpgradeWindowsDotNet( const CTaskUpgradeWindowsDotNet & );

    // Private assignment operator.
    const CTaskUpgradeWindowsDotNet & operator =( const CTaskUpgradeWindowsDotNet & );

    //////////////////////////////////////////////////////////////////////////
    // Private types
    //////////////////////////////////////////////////////////////////////////
    typedef CTaskUpgrade BaseClass;

}; //*** class CTaskUpgradeWindowsDotNet
